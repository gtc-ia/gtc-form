// Full HTML remains the same except for the updated script below
<script>
  const form = document.getElementById('accessForm');
  const actionSelect = document.getElementById('action');
  const nameGroup = document.getElementById('nameGroup');
  const messageBox = document.getElementById('message');

  actionSelect.addEventListener('change', () => {
    nameGroup.style.display = actionSelect.value === 'register' ? 'block' : 'none';
  });

  function isValidPassword(password) {
    const regex = /^(?=.*[a-zA-Z])(?=.*\d)(?=.*[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]).{8,}$/;
    return regex.test(password);
  }

  function showPasswordStrength(password) {
    const strengthBar = document.getElementById('passwordStrength');
    if (!strengthBar) return;

    let strength = 0;
    if (password.length >= 8) strength++;
    if (/[A-Z]/.test(password)) strength++;
    if (/[0-9]/.test(password)) strength++;
    if (/[^A-Za-z0-9]/.test(password)) strength++;

    const levels = ['Weak', 'Fair', 'Good', 'Strong'];
    const colors = ['#ff4d4d', '#ffa500', '#00bfff', '#00e676'];

    strengthBar.textContent = `Password strength: ${levels[strength - 1] || 'Very weak'}`;
    strengthBar.style.color = colors[strength - 1] || '#fff';
  }

  document.getElementById('password').addEventListener('input', (e) => {
    showPasswordStrength(e.target.value);
  });

  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    const action = actionSelect.value;
    const email = document.getElementById('email').value;
    const name = document.getElementById('name').value;
    const password = document.getElementById('password').value;
    const source = document.getElementById('source').value;

    if (action === 'register' && !isValidPassword(password)) {
      messageBox.textContent = '❗ Password must be at least 8 characters and include letters, numbers, and special characters.';
      messageBox.style.color = 'orange';
      return;
    }

    const formData = { action, email, name, password, source };
    messageBox.textContent = '⏳ Sending your request...';

    try {
      const response = await fetch("https://kfilipenko.app.n8n.cloud/webhook/gtc-access", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(formData)
      });

      const result = await response.json();

      if (response.ok) {
        messageBox.textContent = `✅ ${result.message || 'Your request was successfully sent. Please check your inbox.'}`;
        messageBox.style.color = 'lightgreen';
        form.reset();
        nameGroup.style.display = 'block';
        showPasswordStrength('');
      } else {
        messageBox.textContent = `❗ ${result.message || 'Something went wrong. Please try again.'}`;
        messageBox.style.color = 'orange';
      }
    } catch (error) {
      console.error('Error:', error);
      messageBox.textContent = '❌ Failed to send request. Please check your connection and try again.';
      messageBox.style.color = 'red';
    }
  });
</script>
<div id="passwordStrength" style="margin-top: 8px; font-size: 12px; color: #aaa;"></div>
